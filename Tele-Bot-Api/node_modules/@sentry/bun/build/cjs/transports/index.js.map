{"version":3,"file":"index.js","sources":["../../../src/transports/index.ts"],"sourcesContent":["import { createTransport, suppressTracing } from '@sentry/core';\nimport type { BaseTransportOptions, Transport, TransportMakeRequestResponse, TransportRequest } from '@sentry/types';\nimport { rejectedSyncPromise } from '@sentry/utils';\n\nexport interface BunTransportOptions extends BaseTransportOptions {\n  /** Custom headers for the transport. Used by the XHRTransport and FetchTransport */\n  headers?: { [key: string]: string };\n}\n\n/**\n * Creates a Transport that uses the Fetch API to send events to Sentry.\n */\nexport function makeFetchTransport(options: BunTransportOptions): Transport {\n  function makeRequest(request: TransportRequest): PromiseLike<TransportMakeRequestResponse> {\n    const requestOptions: RequestInit = {\n      body: request.body,\n      method: 'POST',\n      headers: options.headers,\n    };\n\n    try {\n      return suppressTracing(() => {\n        return fetch(options.url, requestOptions).then(response => {\n          return {\n            statusCode: response.status,\n            headers: {\n              'x-sentry-rate-limits': response.headers.get('X-Sentry-Rate-Limits'),\n              'retry-after': response.headers.get('Retry-After'),\n            },\n          };\n        });\n      });\n    } catch (e) {\n      return rejectedSyncPromise(e);\n    }\n  }\n\n  return createTransport(options, makeRequest);\n}\n"],"names":["suppressTracing","rejectedSyncPromise","createTransport"],"mappings":";;;;;AASA;AACA;AACA;AACO,SAAS,kBAAkB,CAAC,OAAO,EAAkC;AAC5E,EAAE,SAAS,WAAW,CAAC,OAAO,EAA+D;AAC7F,IAAI,MAAM,cAAc,GAAgB;AACxC,MAAM,IAAI,EAAE,OAAO,CAAC,IAAI;AACxB,MAAM,MAAM,EAAE,MAAM;AACpB,MAAM,OAAO,EAAE,OAAO,CAAC,OAAO;AAC9B,KAAK,CAAA;AACL;AACA,IAAI,IAAI;AACR,MAAM,OAAOA,oBAAe,CAAC,MAAM;AACnC,QAAQ,OAAO,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE,cAAc,CAAC,CAAC,IAAI,CAAC,YAAY;AACnE,UAAU,OAAO;AACjB,YAAY,UAAU,EAAE,QAAQ,CAAC,MAAM;AACvC,YAAY,OAAO,EAAE;AACrB,cAAc,sBAAsB,EAAE,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,sBAAsB,CAAC;AAClF,cAAc,aAAa,EAAE,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC;AAChE,aAAa;AACb,WAAW,CAAA;AACX,SAAS,CAAC,CAAA;AACV,OAAO,CAAC,CAAA;AACR,KAAM,CAAA,OAAO,CAAC,EAAE;AAChB,MAAM,OAAOC,yBAAmB,CAAC,CAAC,CAAC,CAAA;AACnC,KAAI;AACJ,GAAE;AACF;AACA,EAAE,OAAOC,oBAAe,CAAC,OAAO,EAAE,WAAW,CAAC,CAAA;AAC9C;;;;"}